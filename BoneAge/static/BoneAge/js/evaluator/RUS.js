/* RUS等级、分数、年龄转换表 */
var grade_to_age = {
    'male' : {
        0.0 : {min : 0, max : 0},
        0.1 : {min : 1, max : 1},
        0.2 : {min : 2, max : 2},
        0.3 : {min : 3, max : 3},
        0.4 : {min : 4, max : 5},
        0.5 : {min : 6, max : 7},
        0.6 : {min : 8, max : 9},
        0.7 : {min : 10, max : 11},
        0.8 : {min : 12, max : 13},
        0.9 : {min : 14, max : 15},
        1.0 : {min : 16, max : 17},
        1.1 : {min : 18, max : 19},
        1.2 : {min : 20, max : 22},
        1.3 : {min : 23, max : 24},
        1.4 : {min : 25, max : 27},
        1.5 : {min : 28, max : 29},
        1.6 : {min : 30, max : 31},
        1.7 : {min : 32, max : 33},
        1.8 : {min : 34, max : 35},
        1.9 : {min : 36, max : 38},
        2.0 : {min : 39, max : 40},
        2.1 : {min : 41, max : 42},
        2.2 : {min : 43, max : 44},
        2.3 : {min : 45, max : 47},
        2.4 : {min : 48, max : 49},
        2.5 : {min : 50, max : 51},
        2.6 : {min : 52, max : 54},
        2.7 : {min : 55, max : 56},
        2.8 : {min : 57, max : 59},
        2.9 : {min : 60, max : 62},
        3.0 : {min : 63, max : 63},
        3.1 : {min : 64, max : 64},
        3.2 : {min : 65, max : 65},
        3.3 : {min : 66, max : 66},
        3.4 : {min : 67, max : 67},
        3.5 : {min : 68, max : 68},
        3.6 : {min : 69, max : 69},
        3.7 : {min : 70, max : 71},
        3.8 : {min : 72, max : 72},
        3.9 : {min : 73, max : 74},
        4.0 : {min : 75, max : 75},
        4.2 : {min : 76, max : 76},
        4.4 : {min : 77, max : 77},
        4.5 : {min : 78, max : 78},
        4.6 : {min : 79, max : 79},
        4.7 : {min : 80, max : 80},
        4.8 : {min : 81, max : 81},
        4.9 : {min : 82, max : 83},
        5.0 : {min : 84, max : 84},
        5.1 : {min : 85, max : 85},
        5.2 : {min : 86, max : 87},
        5.3 : {min : 88, max : 88},
        5.4 : {min : 89, max : 90},
        5.5 : {min : 91, max : 91},
        5.6 : {min : 92, max : 93},
        5.7 : {min : 94, max : 95},
        5.8 : {min : 96, max : 97},
        5.9 : {min : 98, max : 99},
        6.0 : {min : 100, max : 100},
        6.1 : {min : 101, max : 101},
        6.2 : {min : 102, max : 102},
        6.3 : {min : 103, max : 103},
        6.4 : {min : 104, max : 105},
        6.5 : {min : 106, max : 108},
        6.6 : {min : 109, max : 109},
        6.7 : {min : 110, max : 111},
        6.8 : {min : 112, max : 113},
        6.9 : {min : 114, max : 115},
        7.0 : {min : 116, max : 117},
        7.1 : {min : 118, max : 119},
        7.2 : {min : 120, max : 122},
        7.3 : {min : 123, max : 124},
        7.4 : {min : 125, max : 127},
        7.5 : {min : 128, max : 130},
        7.6 : {min : 131, max : 133},
        7.7 : {min : 134, max : 137},
        7.8 : {min : 138, max : 139},
        7.9 : {min : 140, max : 142},
        8.0 : {min : 143, max : 146},
        8.1 : {min : 147, max : 152},
        8.2 : {min : 153, max : 156},
        8.3 : {min : 157, max : 159},
        8.4 : {min : 160, max : 164},
        8.5 : {min : 165, max : 168},
        8.6 : {min : 169, max : 173},
        8.7 : {min : 174, max : 181},
        8.8 : {min : 182, max : 183},
        8.9 : {min : 184, max : 191},
        9.0 : {min : 192, max : 192},
        9.1 : {min : 193, max : 199},
        9.2 : {min : 200, max : 201},
        9.3 : {min : 202, max : 204},
        9.4 : {min : 205, max : 209},
        9.5 : {min : 210, max : 215},
        9.6 : {min : 216, max : 220},
        9.7 : {min : 221, max : 225},
        9.8 : {min : 226, max : 231},
        9.9 : {min : 232, max : 237},
        10.0 : {min : 238, max : 242},
        10.1 : {min : 243, max : 251},
        10.2 : {min : 252, max : 254},
        10.3 : {min : 255, max : 260},
        10.4 : {min : 261, max : 266},
        10.5 : {min : 267, max : 273},
        10.6 : {min : 274, max : 282},
        10.7 : {min : 283, max : 290},
        10.8 : {min : 291, max : 295},
        10.9 : {min : 296, max : 303},
        11.0 : {min : 304, max : 312},
        11.1 : {min : 313, max : 321},
        11.2 : {min : 322, max : 330},
        11.3 : {min : 331, max : 339},
        11.4 : {min : 340, max : 348},
        11.5 : {min : 349, max : 358},
        11.6 : {min : 359, max : 369},
        11.7 : {min : 370, max : 380},
        11.8 : {min : 381, max : 394},
        11.9 : {min : 395, max : 402},
        12.0 : {min : 403, max : 414},
        12.1 : {min : 415, max : 427},
        12.2 : {min : 428, max : 439},
        12.3 : {min : 440, max : 454},
        12.4 : {min : 455, max : 468},
        12.5 : {min : 469, max : 479},
        12.6 : {min : 480, max : 493},
        12.7 : {min : 494, max : 508},
        12.8 : {min : 509, max : 519},
        12.9 : {min : 520, max : 538},
        13.0 : {min : 539, max : 548},
        13.1 : {min : 549, max : 565},
        13.2 : {min : 566, max : 581},
        13.3 : {min : 582, max : 596},
        13.4 : {min : 597, max : 614},
        13.5 : {min : 615, max : 630},
        13.6 : {min : 631, max : 641},
        13.7 : {min : 642, max : 655},
        13.8 : {min : 656, max : 671},
        13.9 : {min : 672, max : 685},
        14.0 : {min : 686, max : 699},
        14.1 : {min : 700, max : 714},
        14.2 : {min : 715, max : 728},
        14.3 : {min : 729, max : 743},
        14.4 : {min : 744, max : 759},
        14.5 : {min : 760, max : 776},
        14.6 : {min : 777, max : 791},
        14.7 : {min : 792, max : 807},
        14.8 : {min : 808, max : 827},
        14.9 : {min : 828, max : 842},
        15.0 : {min : 843, max : 853},
        15.1 : {min : 854, max : 865},
        15.2 : {min : 866, max : 882},
        15.3 : {min : 883, max : 891},
        15.4 : {min : 892, max : 900},
        15.5 : {min : 901, max : 911},
        15.6 : {min : 912, max : 919},
        15.7 : {min : 920, max : 923},
        15.8 : {min : 924, max : 929},
        15.9 : {min : 930, max : 935},
        16.0 : {min : 936, max : 939},
        16.1 : {min : 940, max : 940},
        16.2 : {min : 941, max : 942},
        16.3 : {min : 943, max : 950},
        16.4 : {min : 951, max : 951},
        16.5 : {min : 952, max : 952},
        16.6 : {min : 953, max : 953},
        16.7 : {min : 954, max : 954},
        16.8 : {min : 955, max : 955},
        16.9 : {min : 956, max : 957},
        17.0 : {min : 958, max : 958},
        17.1 : {min : 959, max : 960},
        17.2 : {min : 961, max : 962},
        17.3 : {min : 963, max : 963},
        17.4 : {min : 964, max : 966},
        17.5 : {min : 967, max : 980},
        17.6 : {min : 981, max : 984},
        17.7 : {min : 985, max : 997},
        17.8 : {min : 998, max : 998},
        17.9 : {min : 997, max : 997},
        18.0 : {min : 997, max : 1000},
    },
    'female' : {
        0.0 : {min : 0, max : 2},
        0.1 : {min : 3, max : 5},
        0.2 : {min : 6, max : 8},
        0.3 : {min : 9, max : 11},
        0.4 : {min : 11, max : 15},
        0.5 : {min : 16, max : 21},
        0.6 : {min : 22, max : 25},
        0.7 : {min : 26, max : 29},
        0.8 : {min : 30, max : 34},
        0.9 : {min : 35, max : 41},
        1.0 : {min : 42, max : 45},
        1.1 : {min : 46, max : 49},
        1.2 : {min : 50, max : 53},
        1.3 : {min : 54, max : 58},
        1.4 : {min : 59, max : 62},
        1.5 : {min : 63, max : 65},
        1.6 : {min : 66, max : 68},
        1.7 : {min : 69, max : 72},
        1.8 : {min : 73, max : 74},
        1.9 : {min : 75, max : 77},
        2.0 : {min : 78, max : 79},
        2.1 : {min : 80, max : 81},
        2.2 : {min : 82, max : 83},
        2.3 : {min : 84, max : 85},
        2.4 : {min : 86, max : 88},
        2.5 : {min : 89, max : 90},
        2.6 : {min : 91, max : 92},
        2.7 : {min : 93, max : 94},
        2.8 : {min : 95, max : 96},
        2.9 : {min : 97, max : 99},
        3.0 : {min : 100, max : 100},
        3.1 : {min : 101, max : 101},
        3.2 : {min : 102, max : 103},
        3.3 : {min : 104, max : 104},
        3.4 : {min : 105, max : 106},
        3.5 : {min : 107, max : 107},
        3.6 : {min : 108, max : 109},
        3.7 : {min : 110, max : 111},
        3.8 : {min : 112, max : 113},
        3.9 : {min : 114, max : 115},
        4.0 : {min : 116, max : 116},
        4.1 : {min : 117, max : 117},
        4.2 : {min : 118, max : 118},
        4.3 : {min : 119, max : 119},
        4.4 : {min : 120, max : 120},
        4.5 : {min : 121, max : 122},
        4.6 : {min : 123, max : 123},
        4.7 : {min : 124, max : 125},
        4.8 : {min : 126, max : 127},
        4.9 : {min : 128, max : 129},
        5.0 : {min : 130, max : 132},
        5.1 : {min : 133, max : 135},
        5.2 : {min : 136, max : 138},
        5.3 : {min : 139, max : 141},
        5.4 : {min : 142, max : 145},
        5.5 : {min : 146, max : 149},
        5.6 : {min : 150, max : 152},
        5.7 : {min : 153, max : 154},
        5.8 : {min : 155, max : 157},
        5.9 : {min : 158, max : 161},
        6.0 : {min : 162, max : 165},
        6.1 : {min : 166, max : 169},
        6.2 : {min : 170, max : 174},
        6.3 : {min : 175, max : 178},
        6.4 : {min : 179, max : 183},
        6.5 : {min : 184, max : 188},
        6.6 : {min : 189, max : 193},
        6.7 : {min : 194, max : 198},
        6.8 : {min : 199, max : 203},
        6.9 : {min : 204, max : 208},
        7.0 : {min : 209, max : 213},
        7.1 : {min : 214, max : 219},
        7.2 : {min : 220, max : 224},
        7.3 : {min : 225, max : 230},
        7.4 : {min : 231, max : 237},
        7.5 : {min : 238, max : 242},
        7.6 : {min : 243, max : 248},
        7.7 : {min : 249, max : 254},
        7.8 : {min : 255, max : 260},
        7.9 : {min : 261, max : 266},
        8.0 : {min : 267, max : 274},
        8.1 : {min : 275, max : 282},
        8.2 : {min : 283, max : 290},
        8.3 : {min : 291, max : 298},
        8.4 : {min : 299, max : 306},
        8.5 : {min : 307, max : 314},
        8.6 : {min : 315, max : 323},
        8.7 : {min : 324, max : 331},
        8.8 : {min : 332, max : 341},
        8.9 : {min : 342, max : 349},
        9.0 : {min : 350, max : 359},
        9.1 : {min : 360, max : 369},
        9.2 : {min : 370, max : 380},
        9.3 : {min : 381, max : 389},
        9.4 : {min : 390, max : 399},
        9.5 : {min : 400, max : 409},
        9.6 : {min : 410, max : 420},
        9.7 : {min : 421, max : 430},
        9.8 : {min : 431, max : 441},
        9.9 : {min : 442, max : 452},
        10.0 : {min : 453, max : 462},
        10.1 : {min : 463, max : 473},
        10.2 : {min : 474, max : 484},
        10.3 : {min : 485, max : 495},
        10.4 : {min : 496, max : 506},
        10.5 : {min : 507, max : 519},
        10.6 : {min : 520, max : 531},
        10.7 : {min : 532, max : 544},
        10.8 : {min : 545, max : 557},
        10.9 : {min : 558, max : 570},
        11.0 : {min : 571, max : 583},
        11.1 : {min : 584, max : 596},
        11.2 : {min : 597, max : 609},
        11.3 : {min : 610, max : 622},
        11.4 : {min : 623, max : 635},
        11.5 : {min : 636, max : 647},
        11.6 : {min : 648, max : 659},
        11.7 : {min : 660, max : 672},
        11.8 : {min : 673, max : 683},
        11.9 : {min : 684, max : 701},
        12.0 : {min : 702, max : 712},
        12.1 : {min : 713, max : 727},
        12.2 : {min : 728, max : 748},
        12.3 : {min : 749, max : 761},
        12.4 : {min : 762, max : 779},
        12.5 : {min : 780, max : 789},
        12.6 : {min : 790, max : 808},
        12.7 : {min : 809, max : 819},
        12.8 : {min : 820, max : 835},
        12.9 : {min : 836, max : 851},
        13.0 : {min : 852, max : 860},
        13.1 : {min : 861, max : 872},
        13.2 : {min : 873, max : 885},
        13.3 : {min : 886, max : 894},
        13.4 : {min : 895, max : 906},
        13.5 : {min : 907, max : 913},
        13.6 : {min : 914, max : 926},
        13.7 : {min : 927, max : 929},
        13.8 : {min : 930, max : 934},
        13.9 : {min : 935, max : 942},
        14.0 : {min : 943, max : 944},
        14.1 : {min : 945, max : 952},
        14.2 : {min : 953, max : 954},
        14.3 : {min : 955, max : 959},
        14.4 : {min : 960, max : 962},
        14.5 : {min : 963, max : 966},
        14.6 : {min : 967, max : 967},
        14.7 : {min : 968, max : 969},
        14.8 : {min : 970, max : 974},
        14.9 : {min : 975, max : 975},
        15.0 : {min : 976, max : 977},
        15.1 : {min : 978, max : 979},
        15.2 : {min : 980, max : 981},
        15.3 : {min : 982, max : 982},
        15.4 : {min : 983, max : 985},
        15.5 : {min : 986, max : 986},
        15.7 : {min : 987, max : 987},
        15.9 : {min : 988, max : 988},
        16.1 : {min : 989, max : 989},
        16.2 : {min : 990, max : 990},
        16.3 : {min : 991, max : 991},
        16.4 : {min : 992, max : 992},
        16.5 : {min : 993, max : 993},
        16.6 : {min : 994, max : 994},
        16.7 : {min : 995, max : 996},
        16.8 : {min : 997, max : 997},
        16.9 : {min : 998, max : 999},
        17.0 : {min : 1000, max : 1000},
    },
};
var level_to_grade = {
    'male' : {
        'radius' : {
            0 : 0,
            1 : 8,
            2 : 11,
            3 : 15,
            4 : 18,
            5 : 31,
            6 : 46,
            7 : 76,
            8 : 118,
            9 : 135,
            10 : 171,
            11 : 188,
            12 : 197,
            13 : 201,
            14 : 209,
        },
        'ulna' : {
            0 : 0,
            1 : 25,
            2 : 30,
            3 : 35,
            4 : 43,
            5 : 61,
            6 : 80,
            7 : 116,
            8 : 157,
            9 : 168,
            10 : 180,
            11 : 187,
            12 : 194,
        },
        'first-metacarpal' : {
            0 : 0,
            1 : 4,
            2 : 5,
            3 : 8,
            4 : 16,
            5 : 22,
            6 : 26,
            7 : 34,
            8 : 39,
            9 : 45,
            10 : 52,
            11 : 66,
        },
        'third-metacarpal' : {
            0 : 0,
            1 : 3,
            2 : 4,
            3 : 5,
            4 : 8,
            5 : 13,
            6 : 19,
            7 : 30,
            8 : 38,
            9 : 44,
            10 : 51,
        },
        'fifth-metacarpal' : {
            0 : 0,
            1 : 3,
            2 : 4,
            3 : 6,
            4 : 9,
            5 : 14,
            6 : 19,
            7 : 31,
            8 : 41,
            9 : 46,
            10 : 50,
        },
        'first-proximal-phalange' : {
            0 : 0,
            1 : 4,
            2 : 5,
            3 : 7,
            4 : 11,
            5 : 17,
            6 : 23,
            7 : 29,
            8 : 36,
            9 : 44,
            10 : 52,
            11 : 59,
            12 : 66,
        },
        'third-proximal-phalange' : {
            0 : 0,
            1 : 3,
            2 : 4,
            3 : 5,
            4 : 8,
            5 : 14,
            6 : 19,
            7 : 23,
            8 : 28,
            9 : 34,
            10 : 40,
            11 : 45,
            12 : 50,
        },
        'fifth-proximal-phalange' : {
            0 : 0,
            1 : 3,
            2 : 4,
            3 : 6,
            4 : 10,
            5 : 16,
            6 : 19,
            7 : 24,
            8 : 28,
            9 : 33,
            10 : 40,
            11 : 44,
            12 : 50,
        },
        'third-middle-phalange' : {
            0 : 0,
            1 : 3,
            2 : 4,
            3 : 5,
            4 : 9,
            5 : 14,
            6 : 18,
            7 : 23,
            8 : 28,
            9 : 35,
            10 : 42,
            11 : 45,
            12 : 50,
        },
        'fifth-middle-phalange' : {
            0 : 0,
            1 : 3,
            2 : 4,
            3 : 6,
            4 : 11,
            5 : 17,
            6 : 21,
            7 : 26,
            8 : 31,
            9 : 36,
            10 : 40,
            11 : 43,
            12 : 49,
        },
        'first-distal-phalange' : {
            0 : 0,
            1 : 4,
            2 : 5,
            3 : 6,
            4 : 9,
            5 : 19,
            6 : 28,
            7 : 36,
            8 : 43,
            9 : 46,
            10 : 51,
            11 : 67,
        },
        'third-distal-phalange' : {
            0 : 0,
            1 : 3,
            2 : 4,
            3 : 5,
            4 : 9,
            5 : 15,
            6 : 23,
            7 : 29,
            8 : 33,
            9 : 37,
            10 : 40,
            11 : 49,
        },
        'fifth-distal-phalange' : {
            0 : 0,
            1 : 3,
            2 : 4,
            3 : 6,
            4 : 11,
            5 : 17,
            6 : 23,
            7 : 29,
            8 : 32,
            9 : 36,
            10 : 40,
            11 : 49,
        },
    },
    'female' : {
        'radius' : {
            0 : 0,
            1 : 10,
            2 : 15,
            3 : 22,
            4 : 25,
            5 : 40,
            6 : 59,
            7 : 91,
            8 : 125,
            9 : 138,
            10 : 178,
            11 : 192,
            12 : 199,
            13 : 203,
            14 : 210,
        },
        'ulna' : {
            0 : 0,
            1 : 27,
            2 : 31,
            3 : 36,
            4 : 50,
            5 : 73,
            6 : 95,
            7 : 120,
            8 : 157,
            9 : 168,
            10 : 176,
            11 : 182,
            12 : 189,
        },
        'first-metacarpal' : {
            0 : 0,
            1 : 5,
            2 : 7,
            3 : 10,
            4 : 16,
            5 : 23,
            6 : 28,
            7 : 34,
            8 : 41,
            9 : 47,
            10 : 53,
            11 : 66,
        },
        'third-metacarpal' : {
            0 : 0,
            1 : 3,
            2 : 5,
            3 : 6,
            4 : 9,
            5 : 14,
            6 : 21,
            7 : 32,
            8 : 40,
            9 : 47,
            10 : 51,
        },
        'fifth-metacarpal' : {
            0 : 0,
            1 : 4,
            2 : 5,
            3 : 7,
            4 : 10,
            5 : 15,
            6 : 22,
            7 : 33,
            8 : 43,
            9 : 47,
            10 : 51,
        },
        'first-proximal-phalange' : {
            0 : 0,
            1 : 6,
            2 : 7,
            3 : 8,
            4 : 11,
            5 : 17,
            6 : 26,
            7 : 32,
            8 : 38,
            9 : 45,
            10 : 53,
            11 : 60,
            12 : 67,
        },
        'third-proximal-phalange' : {
            0 : 0,
            1 : 3,
            2 : 5,
            3 : 7,
            4 : 9,
            5 : 15,
            6 : 20,
            7 : 25,
            8 : 29,
            9 : 35,
            10 : 41,
            11 : 46,
            12 : 51,
        },
        'fifth-proximal-phalange' : {
            0 : 0,
            1 : 4,
            2 : 5,
            3 : 7,
            4 : 11,
            5 : 18,
            6 : 21,
            7 : 25,
            8 : 29,
            9 : 34,
            10 : 40,
            11 : 45,
            12 : 50,
        },
        'third-middle-phalange' : {
            0 : 0,
            1 : 4,
            2 : 5,
            3 : 7,
            4 : 10,
            5 : 16,
            6 : 21,
            7 : 25,
            8 : 29,
            9 : 35,
            10 : 43,
            11 : 46,
            12 : 51,
        },
        'fifth-middle-phalange' : {
            0 : 0,
            1 : 3,
            2 : 5,
            3 : 7,
            4 : 12,
            5 : 19,
            6 : 23,
            7 : 27,
            8 : 32,
            9 : 35,
            10 : 39,
            11 : 43,
            12 : 49,
        },
        'first-distal-phalange' : {
            0 : 0,
            1 : 5,
            2 : 6,
            3 : 8,
            4 : 10,
            5 : 20,
            6 : 31,
            7 : 38,
            8 : 44,
            9 : 45,
            10 : 52,
            11 : 67,
        },
        'third-distal-phalange' : {
            0 : 0,
            1 : 3,
            2 : 5,
            3 : 7,
            4 : 10,
            5 : 16,
            6 : 24,
            7 : 30,
            8 : 33,
            9 : 36,
            10 : 39,
            11 : 49,
        },
        'fifth-distal-phalange' : {
            0 : 0,
            1 : 5,
            2 : 6,
            3 : 7,
            4 : 11,
            5 : 18,
            6 : 25,
            7 : 29,
            8 : 33,
            9 : 35,
            10 : 39,
            11 : 49,
        },
    },
}
var level14_to_level8 = {
    'radius' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4',
        5 : '5(0)',
        6 : '5(2)',
        7 : '6',
        8 : '7(0)',
        9 : '7(2)',
        10 : '8(0)',
        11 : '8(1)',
        12 : '8(2)',
        13 : '8(3)',
        14 : '8(4)',
    },
    'ulna' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4',
        5 : '5(0)',
        6 : '5(2)',
        7 : '6',
        8 : '7(0)',
        9 : '7(1)',
        10 : '7(2)',
        11 : '7(3)',
        12 : '7(4)',
    },
    'first-metacarpal' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4',
        5 : '5(0)',
        6 : '5(2)',
        7 : '6(0)',
        8 : '6(2)',
        9 : '7(0)',
        10 : '7(2)',
        11 : '8',
    },
    'third-metacarpal' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4(0)',
        5 : '4(2)',
        6 : '5',
        7 : '6',
        8 : '7(0)',
        9 : '7(2)',
        10 : '8',
    },
    'fifth-metacarpal' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4(0)',
        5 : '4(2)',
        6 : '5',
        7 : '6',
        8 : '7(0)',
        9 : '7(2)',
        10 : '8',
    },
    'first-proximal-phalange' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4(0)',
        5 : '4(2)',
        6 : '5(0)',
        7 : '5(2)',
        8 : '6(0)',
        9 : '6(2)',
        10 : '7(0)',
        11 : '7(2)',
        12 : '8',
    },
    'third-proximal-phalange' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4(0)',
        5 : '4(2)',
        6 : '5(0)',
        7 : '5(2)',
        8 : '6(0)',
        9 : '6(2)',
        10 : '7(0)',
        11 : '7(2)',
        12 : '8',
    },
    'fifth-proximal-phalange' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4(0)',
        5 : '4(2)',
        6 : '5(0)',
        7 : '5(2)',
        8 : '6(0)',
        9 : '6(2)',
        10 : '7(0)',
        11 : '7(2)',
        12 : '8',
    },
    'third-middle-phalange' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4(0)',
        5 : '4(2)',
        6 : '5(0)',
        7 : '5(2)',
        8 : '6(0)',
        9 : '6(2)',
        10 : '7(0)',
        11 : '7(2)',
        12 : '8',
    },
    'fifth-middle-phalange' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4(0)',
        5 : '4(2)',
        6 : '5(0)',
        7 : '5(2)',
        8 : '6(0)',
        9 : '6(2)',
        10 : '7(0)',
        11 : '7(2)',
        12 : '8',
    },
    'first-distal-phalange' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4',
        5 : '5(0)',
        6 : '5(2)',
        7 : '6(0)',
        8 : '6(2)',
        9 : '7(0)',
        10 : '7(2)',
        11 : '8',
    },
    'third-distal-phalange' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4',
        5 : '5(0)',
        6 : '5(2)',
        7 : '6(0)',
        8 : '6(2)',
        9 : '7(0)',
        10 : '7(2)',
        11 : '8',
    },
    'fifth-distal-phalange' : {
        0 : '0',
        1 : '1',
        2 : '2',
        3 : '3',
        4 : '4',
        5 : '5(0)',
        6 : '5(2)',
        7 : '6(0)',
        8 : '6(2)',
        9 : '7(0)',
        10 : '7(2)',
        11 : '8',
    },
}

/* RUS全局方法 */

//切换骨骼时对骨骼详情部分（评分评级、备注、骨龄）的页面变化
$.fn.switch_bone = function(bone_name_key){
    $("div[class=cropper-canvas] img").css('filter', 'contrast('+ contrast +'%)' + 'brightness('+ brightness +'%)');
    $.fn.update_bone_age()
    var bone = bones[bone_name_key]
    if(bone['error'] == 0){
        $("#bone_discription").attr('hidden','hidden')
        $("#form_bone_details").removeAttr('hidden')
        $("#modify_bone_position").attr('hidden','hidden')
        $("#modify_bone_detail").attr('hidden','hidden')
        $('small[id^=bone_discription_text]').attr('hidden','hidden')
        $("#bone_details_name").text(bone['name'])
        $("#bone_details_remarks").val(bone['remarks'])
        if(bone['level'] > 0){
            $("#bone_discription").removeAttr("hidden", "hidden");
            $("#bone_discription_img").attr("src", url_static + "BoneAge/img/RUS/" + bone_name_key + "-" + bone['level'] + ".png")
            $("#bone_discription_text_" + bone_name_key + "_" + bone['level']).removeAttr('hidden', 'hidden')
        }
        switch (bone_name_key) {
            case 'radius' : $("#bone_details_level").attr('max','14'); break;
            case 'ulna' : $("#bone_details_level").attr('max','12'); break;
            case 'first-metacarpal' : $("#bone_details_level").attr('max','11'); break;
            case 'third-metacarpal' : $("#bone_details_level").attr('max','10'); break;
            case 'fifth-metacarpal' : $("#bone_details_level").attr('max','10'); break;
            case 'first-proximal-phalange' : $("#bone_details_level").attr('max','12'); break;
            case 'third-proximal-phalange' : $("#bone_details_level").attr('max','12'); break;
            case 'fifth-proximal-phalange' : $("#bone_details_level").attr('max','12'); break;
            case 'third-middle-phalange' : $("#bone_details_level").attr('max','12'); break;
            case 'fifth-middle-phalange' : $("#bone_details_level").attr('max','12'); break;
            case 'first-distal-phalange' : $("#bone_details_level").attr('max','11'); break;
            case 'third-distal-phalange' : $("#bone_details_level").attr('max','11'); break;
            case 'fifth-distal-phalange' : $("#bone_details_level").attr('max','11'); break;
            default:
                alert('致命错误：json中未找到该骨骼');
        }
        if(bone['level'] >= 0){
            $("#bone_details_level_label").text(bone['level'] + " | " + level14_to_level8[bone_name_key][bone['level']])
            $("#level-" + bone_name_key).text(bone['level'] + " | " + level14_to_level8[bone_name_key][bone['level']] + "级")
            $("#bone_details_level").val(bone['level'])
        }
        else{
            $("#bone_details_level_label").text("？")
            $("#bone_details_level").val(0)
        }
    }
    else{
        $("#bone_details_name").text(bone['name'] + "（" + bone['error_message'] + "）")
        $("#form_bone_details").attr('hidden','hidden')
    }
    $("#bone_details_level").focus()
};
/* 如果所有骨骼等级数据与定位正常，则计算分数并显示参考年龄 */
$.fn.update_bone_age = function(){
    $('#warning_age_misregistration').attr('hidden', 'hidden');
    $('#bone_age_great_differ_warning').hide();
    $("#bone_age").removeAttr('disabled');
    $("#bone_age").attr('placeholder','')
    $('#label_bone_age').removeClass('text-danger');
    $("#label_bone_age").text('');
    var is_valid = true
    $.each(bones, function(bone_name_key, bone_details){
        if(bone_details['level'] < 0) is_valid = false
        if(bone_details['error'] != 0) is_valid = false
    })
    if(is_valid){
        grade = 0
        bone_age = -1
        $.each(bones, function(bone_name_key,bone_details){
            grade += level_to_grade[sex][bone_name_key][bone_details['level']]
        })
        $.each(grade_to_age[sex], function(age,range){
            if(grade >= range['min'] && grade <= range['max']){
                bone_age = age
            }
        })
        if(bone_age >= 0){
            $("#bone_age").val(bone_age);
            $("#label_bone_age").text(bone_age + "岁");
            $("#label_bone_grade").text(grade + "分");
            // 差距过大提示
            if(Math.abs(actual_age - bone_age) >= 1){
                $("#warning_age_misregistration").removeAttr('hidden');
                $("#bone_age_great_differ_warning").show()
            }
        }
    }
    else{
        $("#bone_age").attr('disabled', 'disabled');
        $("#bone_age").attr('placeholder', '*无法计算，骨骼数据存在错误*');
        $("#label_bone_age").addClass('text-danger');
        $("#label_bone_age").text('*无法计算*');
    }
};

/* RUS页面初始化 */
$(document).ready(function () {
    /*popover提示框全局覆盖*/
    var tooltipTriggerList = Array.prototype.slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })

    //骨骼等级14转8
    $.fn.switch_bone('fifth-distal-phalange')
    $.fn.switch_bone('fifth-middle-phalange')
    $.fn.switch_bone('fifth-proximal-phalange')
    $.fn.switch_bone('fifth-metacarpal')
    $.fn.switch_bone('third-distal-phalange')
    $.fn.switch_bone('third-middle-phalange')
    $.fn.switch_bone('third-proximal-phalange')
    $.fn.switch_bone('third-metacarpal')
    $.fn.switch_bone('first-distal-phalange')
    $.fn.switch_bone('first-proximal-phalange')
    $.fn.switch_bone('first-metacarpal')
    $.fn.switch_bone('ulna')
    $.fn.switch_bone('radius')
    $.fn.switch_bone(default_bone)

    /* 焦点至评级条 */
    $("#bone_details_level").focus()

    /* 如果数据库中存在骨龄数据，则用数据库中的值 */
    if(task['bone_age'] >= 0){
        $("#bone_age").val(task['bone_age']);
        $("#label_bone_age").text(task['bone_age'] + "岁");
    }
});

/* 评分评级修改后修改骨骼等级，弹出保存按钮 */
$("#bone_details_level").on('input', function (e) { 
    var bone_name_key = $(".list-group-item-action.active>span[id^=view-]").attr('id').substring(5)
    var bone = bones[bone_name_key]
    level = bone['level']
    $("#level-fifth-metacarpal").removeClass('text-danger')
    $("#bone_details_level_label").text($(this).val() + " | " + level14_to_level8[bone_name_key][$(this).val()])
    $("#level-" + bone_name_key).text(bone['level'] + " | " + level14_to_level8[bone_name_key][bone['level']] + "级")
    $("#modify_bone_detail").removeAttr('hidden')
    if($(this).val() >= 0){
        $("#bone_discription").removeAttr("hidden", "hidden");
        $("small[id^=bone_discription_text_]").attr('hidden', 'hidden')
        $("#bone_discription_text_" + bone_name_key + "_" + $(this).val()).removeAttr('hidden', 'hidden')
        $("#bone_discription_img").attr("src", url_static + "BoneAge/img/RUS/" + bone_name_key + "-" + $(this).val() + ".png")
    }
    else{
        $("#bone_discription").attr('hidden','hidden')
    }
    
    bone['level'] = $("#bone_details_level").val()
    $.fn.update_bone_age()
    bone['level'] = level
});