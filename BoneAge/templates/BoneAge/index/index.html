{% extends 'base.html' %}

{% block title %}{{ user.username }} 的主页｜骨龄评分系统{% endblock %}

{% block nav_boneage_active %}active{% endblock %}

{% block css %}
{% endblock %}

{% block content %}
{% load static %}
{% load BoneAge_global_tags %}

<div class="alert alert-primary d-flex justify-content-between" role="alert">
    <span>{{ user.last_name|time_period_alert }}。欢迎使用骨龄评分系统。</span>
    <a data-bs-toggle="offcanvas" href="#toolbar_right">个人设置 <i class="bi bi-gear"></i></a>
</div>

<div class="row">
    <div class="col-6 border-end">
        <h2 class="text-center">待完成任务</h2>
        {% if unfinished_tasks %}
            <ul class="list-group list-group-flush mb-2">
                {% for task in unfinished_tasks %}
                    <a href="{% url 'BoneAge_evaluator' task.id %}" class="list-group-item list-group-item-action d-flex justify-content-between">
                        <div>· {{task.dcm_file.patient.name}}（{{task.dcm_file.patient.Patient_Id}}）</div>
                        <div>{{task.dcm_file.patient.get_sex_display}}</div>
                        {% if task.dcm_file.Study_Date %}
                            <div>{{task.dcm_file.Study_Date}}</div>
                        {% else %}
                            <div><span class="text-danger">Study Date读取失败</span></div>
                        {% endif %}
                        <div>dcm ID：{{task.dcm_file.id}}</div>
                    </a>
                {% endfor %}
            </ul>
        {% else %}
            暂无未完成的任务。
        {% endif %}
    </div>
    <div class="col-6 border-end">
        <h2 class="text-center text-success">已完成任务</h2>
        {% if finished_tasks %}
            <ul class="list-group list-group-flush mb-2">
                {% for task in finished_tasks %}
                    <a href="{% url 'BoneAge_evaluator' task.id %}" class="list-group-item list-group-item-action d-flex justify-content-between">
                        <div>· {{task.dcm_file.patient.name}}（{{task.dcm_file.patient.Patient_Id}}）</div>
                        {% if task.dcm_file.Study_Date %}
                            <div>{{task.dcm_file.Study_Date}}</div>
                        {% else %}
                            <div><span class="text-danger">Study Date读取失败</span></div>
                        {% endif %}
                        <div>{{task.dcm_file.id}}</div>
                    </a>
                {% endfor %}
            </ul>
        {% else %}
            暂无已完成的任务。
        {% endif %}
    </div>
</div>

{% include 'BoneAge/index/tool_bar.html' %}

{% endblock %}

{% block js %}
{% endblock %}