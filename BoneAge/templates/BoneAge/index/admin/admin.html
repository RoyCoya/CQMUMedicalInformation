{% extends 'BoneAge/base.html' %}
{% load static %}
{% load BoneAge_global_tags %}

{% block title_BoneAge %}管理后台{% endblock title_BoneAge %}

{% block nav_BoneAge_index %}active{% endblock nav_BoneAge_index %}

{% block css_BoneAge %}
<link rel="stylesheet" href="{% static '/BoneAge/css/admin.css' %}">
{% endblock css_BoneAge %}

{% block content_BoneAge %}
{% comment %} {% if error_dcm_count > 0 %}
<div class="alert alert-warning d-flex justify-content-between" role="alert">
    <span>存在 {{error_dcm_count}} 个待处理错误报告，<a id="analyze" href="#">点击此处处理</a></span>
    <a data-bs-toggle="offcanvas" href="#account_settings">个人设置 <i class="bi bi-gear"></i></a>
</div>
{% else %}
<div class="alert alert-success d-flex justify-content-between" role="alert">
    <span>所有任务正常运行中。</span>
    <a data-bs-toggle="offcanvas" href="#account_settings">个人设置 <i class="bi bi-gear"></i></a>
</div>
{% endif %} {% endcomment %}
<div class="alert alert-primary d-flex justify-content-between" role="alert">
    <span>{{ user.last_name|time_period_alert }}。欢迎使用骨龄评分系统。</span>
    <a data-bs-toggle="offcanvas" href="#account_settings">个人设置 <i class="bi bi-gear"></i></a>
</div>

<div class="row mt-3">
    <!-- 系统配置区 -->
    <div class="col-4 border-end">{% include 'BoneAge/index/admin/system_configuration.html' %}</div>
    <!-- 任务分配区 -->
    <div class="col-8">{% include 'BoneAge/index/admin/task_allocation.html' %}</div>
</div>

<!-- 个人设置侧边栏 -->
{% include 'BoneAge/index/admin/account_settings.html' %}
<!-- 分配任务弹窗 -->
{% include 'BoneAge/index/admin/modal_task_allocation.html' %}
<!-- 删除任务弹窗 -->
{% include 'BoneAge/index/admin/modal_task_delete.html' %}

{% endblock content_BoneAge %}

{% block js_BoneAge %}
<script src="{% static 'BoneAge/js/admin/admin.js' %}"></script>
<script>
    var tooltipTriggerList = Array.prototype.slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })
    var url_api_allocate_tasks = "{% url 'api_BoneAge_allocate_tasks' %}"
    var url_api_delete_tasks = "{% url 'api_BoneAge_delete_tasks' %}"
</script>
{% endblock js_BoneAge %}