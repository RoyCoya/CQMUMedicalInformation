{% load static %}
<!-- 账户信息 -->
<div class="row mt-3">
    <div class="col-5">
        <div class="card shadow">
            <img src="{% static 'BoneAge/img/default_avator.png' %}" class="card-img-top border-bottom" alt="...">
            <div class="card-body text-center">
                <a href="{% url 'logout' %}" class="btn btn-danger">退出登录</a>
            </div>
        </div>
    </div>
    <div class="col-7">
        <div class="mt-2"><strong>姓名：</strong>{{user.last_name}}{{user.first_name}} <i class="bi bi-pen ms-5"></i></div>
        <div class="mt-2"><strong>身份：</strong>{% if user.is_staff %}管理员{% else %}评测员{% endif %}</div>
        <div class="mt-2"><strong>上次登陆：</strong>{{user.last_login|date:"Y-m-d H:i"}}</div>
        <hr>
        <div><strong>其他信息：</strong><span class="text-secondary">暂无</span></div>
    </div>
</div>

<hr class="mt-4">

<!-- 任务统计 -->
<div class="row mt-2">
    <h3 class="text-center">
        <i class="bi bi-bar-chart"></i>
        任务统计
    </h3>
    <div class="mt-2">
        <strong>今日已完成：</strong><span class="text-success">{{finished_today_count}}项</span>
    </div>
    <!-- 总进度 -->
    <div class="mt-2">
        <div>
            <strong>总进度：</strong>
            <span class="text-success">{{finished_tasks_count}}</span> / {{finished_tasks_count|add:unfinished_tasks_count}}
        </div>
        <div class="progress">
            <div class="progress-bar progress-bar-striped progress-bar-animated bg-success"
            style="width: {% widthratio finished_tasks_count finished_tasks_count|add:unfinished_tasks_count 100 %}%">
            </div>
        </div>
    </div>
</div>

<hr class="mt-4">

<div class="row mt-2">
    <h3 class="text-center text-success">
        <i class="bi bi-check2-all text-success"></i>
        已完结
    </h3>
    {% if finished_tasks %}
        <ul class="list-group mt-2 p-0">
            {% for task in finished_tasks %}
                <div id="evaluator_{{task.id}}" class="list-group-item list-group-item-action d-flex justify-content-between">
                    <span>{{task.id}}</span>
                    <a href="{% url 'BoneAge_index' 1 %}">{{task.dcm_file.patient.name}}</a>
                    <span>
                        {{task.dcm_file.patient.get_sex_display}}
                        {% if task.dcm_file.patient.sex == 'Female' %}
                            <i class="bi bi-gender-female" style="color:DeepPink"></i>
                        {% else %}
                            <i class="bi bi-gender-male" style="color:DodgerBlue"></i>
                        {% endif %}
                    </span>
                    <span>{{task.closed_date|date:"n-j H:i"}}</span>
                </div>
            {% endfor %}
        </ul>
    {% else %}
        <span class="text-secondary">暂未完成任务。</span>
    {% endif %}
    {% if finished_tasks_count > 6 %}
        <div class="text-end mt-3"><a class="text-success" href="#">
            共 {{finished_tasks_count}} 项 >>>
        </a></div>
    {% endif %}
</div>